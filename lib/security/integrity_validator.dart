// ignore_for_file: unused_field, constant_identifier_names
import 'dart:convert';
import 'package:crypto/crypto.dart';
import 'package:flutter/foundation.dart';
import 'app_constants.dart';

class _SecurityValidator {
  static const String _k = '7264323032357364';
  static const List<int> _c1 = [0x72,0xb1,0x6d,0x8d,0xf2,0xa1,0x3d,0x1f,0x2f,0x9d,0x1b,0xa5,0xc1,0x9f,0xe0,0xf3,0xa6,0x6a,0x5b,0x3b,0xe9,0xba,0x7c,0x79,0x69,0x2f,0x18,0xe5,0xb2,0x0e,0x28,0x95];
  static const List<int> _c2 = [0xf1,0xc7,0x03,0x83,0x2d,0x43,0x1d,0xe5,0xef,0xa1,0xf2,0xa3,0xdc,0xa6,0x58,0x60,0xb9,0x28,0x7d,0x4d,0x5c,0xe4,0xfa,0x99,0x54,0x7e,0x2a,0xe9,0xdb,0xbf,0xb5,0x7f];
  static const List<int> _c3 = [0x5c,0xa4,0xac,0x21,0x5e,0x37,0x16,0x4e,0xb6,0x52,0x61,0x57,0xd9,0xa7,0xfc,0x68,0x11,0xb8,0xba,0x69,0x8f,0x95,0xb4,0xf8,0x25,0xfd,0x98,0x77,0x6d,0xe7,0x19,0xdd];
  static const List<int> _c4 = [0x95,0xc7,0xa0,0xa7,0x27,0x44,0xd9,0x8b,0xe7,0xda,0x37,0x22,0xe3,0xf7,0x94,0x4c,0xcc,0x6d,0xd1,0xa1,0x65,0x8f,0x7f,0x15,0xa6,0x18,0x0f,0xa0,0xa0,0xad,0xf1,0x2b];
  static const List<int> _c5 = [0xdb,0x2b,0xf8,0x49,0xfa,0x36,0x93,0x79,0x8b,0xe7,0xd4,0xe1,0x96,0x78,0xd6,0x70,0x31,0x75,0xdc,0xcf,0x84,0xee,0xfc,0xfa,0x84,0xb7,0xe9,0xf7,0x34,0x5f,0x6d,0xdc];

  static String _h(String i){final b=utf8.encode(i);final d=sha256.convert(b);return d.toString();}
  static bool _v(String v,List<int> e){final h=_h(v);final eh=e.map((b)=>b.toRadixString(16).padLeft(2,'0')).join('');return h==eh;}

  static Future<bool> performValidation() async {
    try{
      if(!_v(kGitHubUsername,_c1)){debugPrint('Build integrity check failed [0x001]');return false;}
      await Future.delayed(const Duration(milliseconds:50));
      if(!_v(kDeveloperEmail,_c2)){debugPrint('Build integrity check failed [0x002]');return false;}
      await Future.delayed(const Duration(milliseconds:50));
      if(!_v(kLandingAttribution,_c3)){debugPrint('Build integrity check failed [0x003]');return false;}
      await Future.delayed(const Duration(milliseconds:50));
      if(!_v(kProfileAttribution,_c4)){debugPrint('Build integrity check failed [0x004]');return false;}
      await Future.delayed(const Duration(milliseconds:50));
      if(!_v(kGitHubUrl,_c5)){debugPrint('Build integrity check failed [0x005]');return false;}
      return true;
    }catch(e){debugPrint('Build integrity exception: $e');return false;}
  }

  static int get _bcs{int s=0;final b=utf8.encode(kDeveloperEmail);for(var c in b){s+=c;}return s;}
  static bool get _ivb=>_bcs==2557;
}

class IntegrityValidator {
  static Future<bool> validate()async{if(!_SecurityValidator._ivb){debugPrint('Invalid build configuration');return false;}return await _SecurityValidator.performValidation();}
  static bool validateWithKey(String k){final eh='c6c98b1758b89093d17d27e66dbd8e01f4206da2b44fe79c148e90817fe9ee5d';final ph=_SecurityValidator._h(k);return ph==eh;}
}
